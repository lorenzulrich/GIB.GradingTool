<f:layout name="Default" />

<f:section name="Title">GIB Grading Tool</f:section>

<f:section name="Content">

	<f:render partial="Admin/Navigation" arguments="{currentAction:currentAction}"/>

	<h2>Projects</h2>

	<table xmlns:f="http://typo3.org/ns/TYPO3/Fluid/ViewHelpers" class="table table-striped table-hover">
		<thead>
			<tr>
				<th>Project Title</th>
				<th>Language</th>
				<th>Project Manager</th>
				<th>Created</th>
				<th>Last Updated</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
		<f:for each="{projects}" as="project">
			<tr>
				<td>{project.projectTitle}</td>
				<td>{project.language}</td>
				<td><f:link.email title="Click to send e-mail" email="{project.projectManager.primaryElectronicAddress}">{project.projectManager.name}</f:link.email></td>
				<td><f:format.date format="d.m.Y H:i">{project.created}</f:format.date></td>
				<td><f:format.date format="d.m.Y H:i">{project.lastUpdated}</f:format.date></td>
				<td>
					<f:link.action class="btn btn-primary btn-sm" action="editDataSheet" controller="Project" arguments="{project:project}"><i class="fa fa-edit"></i> Edit Data Sheet</f:link.action>
					<div class="btn-group">
						<button type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown">
							Submission <span class="caret"></span>
						</button>
						<ul class="dropdown-menu" role="menu">
							<f:if condition="{project.submissionFormAccess}">
								<f:then>
									<li><f:link.action additionalAttributes="{data-confirm: 'Are you sure?'}" class="returnConfirm" arguments="{project:project}" action="deactivateSubmissionForm" controller="Project"><i class="fa fa-eye-slash"></i> Deactivate Submission</f:link.action></li>
								</f:then>
								<f:else>
									<li><f:link.action additionalAttributes="{data-confirm: 'This will send a notification e-mail to the user. Are you sure?'}" class="returnConfirm" arguments="{project:project}" action="activateSubmissionForm" controller="Project"><i class="fa fa-eye"></i> Activate Submission</f:link.action></li>
								</f:else>
							</f:if>
							<li><f:link.action action="submission" controller="Project" arguments="{project:project}"><i class="fa fa-list-ol"></i> Edit Submission</f:link.action></li>
							<f:if condition="{project.submissionContent}">
								<li><f:link.action action="reviewSubmission" controller="Project" arguments="{project:project}"><i class="fa fa-eye"></i> Review Submission</f:link.action></li>
							</f:if>
						</ul>
					</div>
					<div class="btn-group">
						<button type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown">
							Export <span class="caret"></span>
						</button>
						<ul class="dropdown-menu" role="menu">
							<li><f:link.action target="_blank" action="exportReport" controller="Project" arguments="{project:project}"><i class="fa fa-download"></i> Export PDF</f:link.action></li>
						</ul>
					</div>
					<f:link.action additionalAttributes="{data-confirm: 'Are you sure you want to remove this project?'}" class="btn btn-danger btn-sm returnConfirm" action="remove" controller="Project" arguments="{project:project}"><i class="fa fa-times-circle"></i> Remove</f:link.action>
				</td>
			</tr>
		</f:for>
		</tbody>
	</table>

	<f:form controller="project" action="newDataSheet">
		<p><button class="btn btn-primary" type="submit"><i class="fa fa-plus-square"></i> Add project</button></p>
	</f:form>

</f:section>