<f:layout name="Default" />

<f:section name="Title">GIB Grading Tool</f:section>

<f:section name="Content">

	<f:render partial="Admin/Navigation" arguments="{currentAction:currentAction}"/>

	<h2>Projects</h2>

	<table xmlns:f="http://typo3.org/ns/TYPO3/Fluid/ViewHelpers" class="table table-striped table-hover">
		<thead>
			<tr>
				<th>Project Title</th>
				<th>Project Manager</th>
				<th>Created</th>
				<th>Last Updated</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
		<f:for each="{projects}" as="project">
			<tr>
				<td>{project.projectTitle}</td>
				<td><f:link.email title="Click to send e-mail" email="{project.projectManager.primaryElectronicAddress}">{project.projectManager.name}</f:link.email></td>
				<td><f:format.date format="d.m.Y H:i">{project.created}</f:format.date></td>
				<td><f:format.date format="d.m.Y H:i">{project.lastUpdated}</f:format.date></td>
				<td>
					<f:link.action class="btn btn-primary btn-sm" action="editDataSheet" controller="Project" arguments="{project:project}"><i class="fa fa-edit"></i> Edit Data Sheet</f:link.action>
					<f:if condition="{project.submissionFormAccess}">
						<f:then>
							<f:link.action onclick="return confirm('Are you sure?');" class="btn btn-sm btn-info" arguments="{project:project}" action="deactivateSubmissionForm" controller="Project"><i class="fa fa-eye-slash"></i> Deactivate Submission</f:link.action>
						</f:then>
						<f:else>
							<f:link.action onclick="return confirm('This will send a notification e-mail to the user. Are you sure?');" class="btn btn-sm btn-info" arguments="{project:project}" action="activateSubmissionForm" controller="Project"><i class="fa fa-eye"></i> Activate Submission</f:link.action>
						</f:else>
					</f:if>
					<f:link.action onclick="return confirm('Are you sure you want to remove this project?');" class="btn btn-danger btn-sm" action="remove" controller="Project" arguments="{project:project}"><i class="fa fa-times-circle"></i> Remove</f:link.action>
				</td>
			</tr>
		</f:for>
		</tbody>
	</table>

	<f:form controller="project" action="newDataSheet">
		<p><button class="btn btn-primary" type="submit"><i class="fa fa-plus-square"></i> Add project</button></p>
	</f:form>

</f:section>